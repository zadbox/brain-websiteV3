2025-08-01 04:32:16 [warning  ] Could not import BrainGenTech Agent: cannot import name 'ConversationBufferMemory' from 'langchain_core.memory' (/Users/abderrahim_boussyf/BrainGenTech/BRAIN-TECHNOLOGY-V2/python-service/venv/lib/python3.11/site-packages/langchain_core/memory.py)
2025-08-01 04:32:16 [info     ] Knowledge Router import successful
2025-08-01 04:32:16 [info     ] Using Ollama LLM: llama3.2:1b
/Users/abderrahim_boussyf/BrainGenTech/BRAIN-TECHNOLOGY-V2/python-service/main.py:190: LangChainDeprecationWarning: The class `HuggingFaceEmbeddings` was deprecated in LangChain 0.2.2 and will be removed in 1.0. An updated version of the class exists in the :class:`~langchain-huggingface package and should be used instead. To use it run `pip install -U :class:`~langchain-huggingface` and import as `from :class:`~langchain_huggingface import HuggingFaceEmbeddings``.
  embeddings = HuggingFaceEmbeddings(
INFO:sentence_transformers.SentenceTransformer:Load pretrained SentenceTransformer: all-MiniLM-L6-v2
2025-08-01 04:32:22 [info     ] Using free embeddings: all-MiniLM-L6-v2
INFO:httpx:HTTP Request: GET http://localhost:6333 "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: GET http://localhost:6333/collections/braingen_tech "HTTP/1.1 200 OK"
/Users/abderrahim_boussyf/BrainGenTech/BRAIN-TECHNOLOGY-V2/python-service/venv/lib/python3.11/site-packages/torch/nn/modules/module.py:1762: FutureWarning: `encoder_attention_mask` is deprecated and will be removed in version 4.55.0 for `BertSdpaSelfAttention.forward`.
  return forward_call(*args, **kwargs)
2025-08-01 04:32:22 [warning  ] Vector store initialization failed: Existing Qdrant collection is configured for dense vectors with 1024 dimensions. Selected embeddings are 384-dimensional. If you want to recreate the collection, set `force_recreate` parameter to `True`.
2025-08-01 04:32:22 [info     ] Starting server with configuration access_log=True host=0.0.0.0 log_level=info port=8001 reload=False workers=1
INFO:     Started server process [6400]
INFO:     Waiting for application startup.
2025-08-01 04:32:22 [info     ] Starting BrainGenTech LangChain API v2.2.0
2025-08-01 04:32:22 [info     ] LLM initialized: llama3.2:1b
2025-08-01 04:32:22 [info     ] Vector store available: False
2025-08-01 04:32:22 [info     ] Max conversations: 1000
2025-08-01 04:32:22 [info     ] Memory retention: 24 hours
2025-08-01 04:32:22 [info     ] BrainGenTech Agent disabled for testing - using direct LLM
2025-08-01 04:32:22 [info     ] Knowledge Router initialized successfully
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8001 (Press CTRL+C to quit)
INFO:     127.0.0.1:56932 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:56941 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:56948 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:56953 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:56977 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:56986 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:56991 - "GET /search-knowledge?query=services&limit=1 HTTP/1.1" 503 Service Unavailable
INFO:     127.0.0.1:56997 - "GET /health HTTP/1.1" 200 OK
2025-08-01 04:33:38 [info     ] Created new memory for session: test-page-1754019211489
2025-08-01 04:33:38 [info     ] Processing message with Knowledge Router: 'Test de connexion'
2025-08-01 04:33:38 [info     ] Using fallback LLM processing
2025-08-01 04:33:38 [info     ] Invoking LLM with prompt length: 1328
2025-08-01 04:33:50 [info     ] LLM response type: <class 'str'>, content: Bonjour ! Je suis ravi de vous aider. Pour la question "Test de connexion", je vais répondre de mani...
2025-08-01 04:33:50 [info     ] Chat processed successfully    confidence=0.95 message_length=17 processing_time=12.439843 session_id=test-page-1754019211489
INFO:     127.0.0.1:57000 - "POST /chat HTTP/1.1" 200 OK
INFO:     127.0.0.1:57007 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:57013 - "GET /search-knowledge?query=test&limit=1 HTTP/1.1" 503 Service Unavailable
INFO:     127.0.0.1:57022 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:57026 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:57035 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:57039 - "GET /health HTTP/1.1" 200 OK
2025-08-01 04:34:30 [info     ] Created new memory for session: brain_1754019187680_egf6mn1ap
2025-08-01 04:34:30 [info     ] Processing message with Knowledge Router: 'hello'
2025-08-01 04:34:30 [info     ] Using fallback LLM processing
2025-08-01 04:34:30 [info     ] Invoking LLM with prompt length: 1304
2025-08-01 04:34:45 [info     ] LLM response type: <class 'str'>, content: Bonjour ! Je suis ravi de vous aider. 

**Pour la question "hello" :**

Je ne peux pas répondre à vo...
2025-08-01 04:34:45 [info     ] Chat processed successfully    confidence=0.792 message_length=5 processing_time=14.843786 session_id=brain_1754019187680_egf6mn1ap
INFO:     127.0.0.1:57043 - "POST /chat HTTP/1.1" 200 OK
INFO:     127.0.0.1:57052 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:57056 - "GET /health HTTP/1.1" 200 OK
2025-08-01 04:35:13 [info     ] Processing message with Knowledge Router: 'Puis-je vous aider avec autre chose ?'
2025-08-01 04:35:13 [info     ] Using fallback LLM processing
2025-08-01 04:35:13 [info     ] Invoking LLM with prompt length: 1368
2025-08-01 04:35:28 [info     ] LLM response type: <class 'str'>, content: Je suis ravi de vous aider dans tous les domaines ! 

Pour la question "Puis-je vous aider avec autr...
2025-08-01 04:35:28 [info     ] Chat processed successfully    confidence=0.786 message_length=37 processing_time=15.310542 session_id=brain_1754019187680_egf6mn1ap
INFO:     127.0.0.1:57064 - "POST /chat HTTP/1.1" 200 OK
INFO:     127.0.0.1:57069 - "GET /health HTTP/1.1" 200 OK
2025-08-01 04:35:38 [info     ] Created new memory for session: brain_1754019191879_b2xoehmfw
2025-08-01 04:35:38 [info     ] Processing message with Knowledge Router: 'Puis-je vous aider avec autre chose ?'
2025-08-01 04:35:38 [info     ] Using fallback LLM processing
2025-08-01 04:35:38 [info     ] Invoking LLM with prompt length: 1368
2025-08-01 04:35:53 [info     ] LLM response type: <class 'str'>, content: Je suis ravi de vous aider avec toute question que je pourrais répondre. Voici ma réponse :

Puis-je...
2025-08-01 04:35:53 [info     ] Chat processed successfully    confidence=0.95 message_length=37 processing_time=15.329504 session_id=brain_1754019191879_b2xoehmfw
INFO:     127.0.0.1:57073 - "POST /chat HTTP/1.1" 200 OK
INFO:     127.0.0.1:57089 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:57093 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:57105 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:57143 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:57153 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:57158 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:57163 - "GET /search-knowledge?query=services&limit=1 HTTP/1.1" 503 Service Unavailable
INFO:     127.0.0.1:57158 - "GET /health HTTP/1.1" 200 OK
2025-08-01 04:37:19 [info     ] Created new memory for session: test-page-1754019409536
2025-08-01 04:37:19 [info     ] Processing message with Knowledge Router: 'Test de connexion'
2025-08-01 04:37:19 [info     ] Using fallback LLM processing
2025-08-01 04:37:19 [info     ] Invoking LLM with prompt length: 1328
2025-08-01 04:37:42 [error    ] LLM invocation timed out after 20 seconds
2025-08-01 04:37:42 [error    ] LLM processing failed: LLM timeout
2025-08-01 04:37:42 [info     ] Chat processed successfully    confidence=0.1 message_length=17 processing_time=23.257967 session_id=test-page-1754019409536
INFO:     127.0.0.1:57172 - "POST /chat HTTP/1.1" 200 OK
INFO:     127.0.0.1:57181 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:57184 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:57191 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:57199 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:57203 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:57219 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:57242 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:57246 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:57256 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:57284 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:57288 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:57316 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:57323 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:57334 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:57343 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:57357 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:57363 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:57382 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:57399 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:57403 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:57414 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:57433 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:57438 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:57449 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:57474 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:57485 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:57516 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:57525 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:57541 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:57557 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:57571 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:57580 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:57598 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:57608 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:57614 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:57632 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:57646 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:57656 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:57675 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:57685 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:57692 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:57713 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:57721 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:57729 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:57744 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:57750 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:57758 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:57780 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:57793 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:57798 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:57812 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:57824 - "GET /health HTTP/1.1" 200 OK
/opt/anaconda3/lib/python3.11/multiprocessing/resource_tracker.py:254: UserWarning: resource_tracker: There appear to be 1 leaked semaphore objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
